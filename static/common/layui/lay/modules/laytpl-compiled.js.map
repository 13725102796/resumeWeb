{"version":3,"sources":["laytpl.js"],"names":[],"mappings":"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","file":"laytpl-compiled.js","sourcesContent":["﻿/**\n \n @Name : layui.laytpl 模板引擎\n @Author：贤心\n @License：LGPL\n \n */\n\nlayui.define(function(exports){\n\n  \"use strict\";\n\n  var config = {\n    open: '{{',\n    close: '}}'\n  };\n\n  var tool = {\n    exp: function(str){\n      return new RegExp(str, 'g');\n    },\n    //匹配满足规则内容\n    query: function(type, _, __){\n      var types = [\n        '#([\\\\s\\\\S])+?',   //js语句\n        '([^{#}])*?' //普通字段\n      ][type || 0];\n      return exp((_||'') + config.open + types + config.close + (__||''));\n    },   \n    escape: function(html){\n      return String(html||'').replace(/&(?!#?[a-zA-Z0-9]+;)/g, '&amp;')\n      .replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/'/g, '&#39;').replace(/\"/g, '&quot;');\n    },\n    error: function(e, tplog){\n      var error = 'Laytpl Error：';\n      typeof console === 'object' && console.error(error + e + '\\n'+ (tplog || ''));\n      return error + e;\n    }\n  };\n\n  var exp = tool.exp, Tpl = function(tpl){\n    this.tpl = tpl;\n  };\n\n  Tpl.pt = Tpl.prototype;\n\n  window.errors = 0;\n\n  //编译模版\n  Tpl.pt.parse = function(tpl, data){\n    var that = this, tplog = tpl;\n    var jss = exp('^'+config.open+'#', ''), jsse = exp(config.close+'$', '');\n    \n    tpl = tpl.replace(/\\s+|\\r|\\t|\\n/g, ' ').replace(exp(config.open+'#'), config.open+'# ')\n    \n    .replace(exp(config.close+'}'), '} '+config.close).replace(/\\\\/g, '\\\\\\\\')\n    \n    .replace(/(?=\"|')/g, '\\\\').replace(tool.query(), function(str){\n      str = str.replace(jss, '').replace(jsse, '');\n      return '\";' + str.replace(/\\\\/g, '') + ';view+=\"';\n    })\n    \n    .replace(tool.query(1), function(str){\n      var start = '\"+(';\n      if(str.replace(/\\s/g, '') === config.open+config.close){\n        return '';\n      }\n      str = str.replace(exp(config.open+'|'+config.close), '');\n      if(/^=/.test(str)){\n        str = str.replace(/^=/, '');\n        start = '\"+_escape_(';\n      }\n      return start + str.replace(/\\\\/g, '') + ')+\"';\n    });\n    \n    tpl = '\"use strict\";var view = \"' + tpl + '\";return view;';\n\n    try{\n      that.cache = tpl = new Function('d, _escape_', tpl);\n      return tpl(data, tool.escape);\n    } catch(e){\n      delete that.cache;\n      return tool.error(e, tplog);\n    }\n  };\n\n  Tpl.pt.render = function(data, callback){\n    var that = this, tpl;\n    if(!data) return tool.error('no data');\n    tpl = that.cache ? that.cache(data, tool.escape) : that.parse(that.tpl, data);\n    if(!callback) return tpl;\n    callback(tpl);\n  };\n\n  var laytpl = function(tpl){\n    if(typeof tpl !== 'string') return tool.error('Template not found');\n    return new Tpl(tpl);\n  };\n\n  laytpl.config = function(options){\n    options = options || {};\n    for(var i in options){\n      config[i] = options[i];\n    }\n  };\n\n  laytpl.v = '1.2.0';\n  \n  exports('laytpl', laytpl);\n\n});"]}