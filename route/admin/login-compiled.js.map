{"version":3,"sources":["login.js"],"names":[],"mappings":"AAAA,MAAM,UAAU,QAAQ,SAAR,CAAhB;AACA,MAAM,QAAQ,QAAQ,OAAR,CAAd;AACA,MAAM,SAAS,QAAQ,mBAAR,CAAf;;AAEA,MAAM,KAAK,MAAM,UAAN,CAAiB;AACxB,UAAM,WADkB;AAExB,UAAM,QAFkB;AAGxB,cAAU,QAHc;AAIxB,cAAS,QAJe;AAKxB,UAAM;AALkB,CAAjB,CAAX;;AAQA,OAAO,OAAP,GAAiB,YAAY;AACzB,QAAI,SAAS,QAAQ,MAAR,EAAb;;AAEA,WAAO,GAAP,CAAW,GAAX,EAAgB,CAAC,GAAD,EAAM,GAAN,KAAa;AACzB,YAAI,MAAJ,CAAW,gBAAX,EAA6B,EAA7B;AAEH,KAHD;;AAKA,WAAO,IAAP,CAAY,GAAZ,EAAiB,CAAC,GAAD,EAAM,GAAN,KAAY;AACzB,YAAI,WAAW,IAAI,IAAJ,CAAS,QAAxB;AACA,YAAI,WAAW,IAAI,IAAJ,CAAS,QAAT,GAAoB,OAAO,UAA1C;AACA,YAAI,WAAW,OAAO,GAAP,CAAW,QAAX,CAAf;;AAEA,WAAG,KAAH,CAAU,6CAA4C,QAAS,GAA/D,EAAmE,CAAC,GAAD,EAAM,IAAN,KAAa;AAC5E,gBAAG,GAAH,EAAO;AACH,oBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,aAFD,MAEK;AACD,oBAAG,KAAK,MAAL,IAAa,CAAhB,EAAkB;AACd,wBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,eAArB,EAAsC,GAAtC;AACH,iBAFD,MAEK;AACD,wBAAG,KAAK,CAAL,EAAQ,QAAR,IAAkB,QAArB,EAA8B;AAC1B;AACA,4BAAI,OAAJ,CAAY,UAAZ,IAAwB,KAAK,CAAL,EAAQ,EAAhC;AACA,4BAAI,QAAJ,CAAa,SAAb;AACH,qBAJD,MAIK;AACD,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,4BAArB,EAAmD,GAAnD;AACH;AACJ;AACJ;AACJ,SAhBD;AAiBH,KAtBD;;AAwBA,WAAO,MAAP;AACH,CAjCD","file":"login-compiled.js","sourcesContent":["const express = require('express');\r\nconst mysql = require('mysql');\r\nconst common = require('../../libs/common');\r\n\r\nconst db = mysql.createPool({\r\n    host: 'localhost',\r\n    user: 'nodejs',\r\n    password: 'nodejs',\r\n    database:'resume',\r\n    port: 3306\r\n});\r\n\r\nmodule.exports = function () {\r\n    var router = express.Router();\r\n\r\n    router.get('/', (req, res)=> {\r\n        res.render('page/login.ejs', {});\r\n\r\n    })\r\n\r\n    router.post('/', (req, res)=>{\r\n        var username = req.body.username;\r\n        var Password = req.body.password + common.MD5_SUFFIX;\r\n        var password = common.md5(Password);\r\n\r\n        db.query(`SELECT * FROM admin_table WHERE username='${username}'`, (err, data)=>{\r\n            if(err){\r\n                res.status(500).send('database error').end();\r\n            }else{\r\n                if(data.length==0){\r\n                    res.status(400).send('no this admin').end();\r\n                }else{\r\n                    if(data[0].password==password){\r\n                        //success\r\n                        req.session['admin_id']=data[0].ID;\r\n                        res.redirect('/admin/');\r\n                    }else{\r\n                        res.status(400).send('this password is incorrect').end();\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    });\r\n\r\n    return router;\r\n}"]}