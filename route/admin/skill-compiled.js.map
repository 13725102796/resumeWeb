{"version":3,"sources":["skill.js"],"names":[],"mappings":"AAAA,MAAM,UAAU,QAAQ,SAAR,CAAhB;AACA,MAAM,QAAQ,QAAQ,OAAR,CAAd;;AAEA,MAAM,KAAK,MAAM,UAAN,CAAiB;AACxB,UAAM,WADkB;AAExB,UAAM,QAFkB;AAGxB,cAAU,QAHc;AAIxB,cAAS,QAJe;AAKxB,UAAM;AALkB,CAAjB,CAAX;;AAQA,OAAO,OAAP,GAAiB,YAAY;AACzB,QAAI,SAAS,QAAQ,MAAR,EAAb;;AAEA,WAAO,GAAP,CAAW,GAAX,EAAgB,CAAC,GAAD,EAAM,GAAN,KAAa;AACzB,YAAI,IAAI,KAAJ,CAAU,EAAd,EAAkB;AACd,gBAAI,IAAI,KAAJ,CAAU,EAAV,IAAgB,KAApB,EAA2B;AACvB,mBAAG,KAAH,CAAU,oCAAmC,IAAI,KAAJ,CAAU,EAAG,EAA1D,EAA6D,CAAC,GAAD,EAAM,IAAN,KAAc;AACvE,wBAAI,GAAJ,EAAS;AACL,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAFD,MAEO;AACH,4BAAI,QAAJ,CAAa,cAAb;AACH;AACJ,iBAND;AAOH,aARD,MAQO;AACH;AACA,oBAAI,IAAJ,CAAS,gBAAT,EAA2B,GAA3B;AACH;AACJ,SAbD,MAaO;AACH,eAAG,KAAH,CAAU,2BAAV,EAAsC,CAAC,GAAD,EAAM,cAAN,KAAwB;AAC1D,oBAAI,GAAJ,EAAS;AACL,wBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,iBAFD,MAEO;AACH,wBAAI,MAAJ,CAAW,gBAAX,EAA6B,EAAC,cAAD,EAA7B;AACH;AACJ,aAND;AAOH;AACJ,KAvBD;;AAyBA,WAAO,IAAP,CAAY,GAAZ,EAAiB,CAAC,GAAD,EAAM,GAAN,KAAa;AAC1B;AACA;;AACA,YAAI,QAAQ,IAAI,IAAJ,CAAS,KAArB;AACA,YAAI,eAAe,IAAI,IAAJ,CAAS,YAA5B;AACA,YAAI,OAAO,IAAI,IAAJ,CAAS,IAApB;AACA,YAAI,CAAC,KAAD,IAAU,CAAC,YAAf,EAA6B;AACzB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,UAArB,EAAiC,GAAjC;AACH,SAFD,MAEO;AACH,gBAAI,IAAI,IAAJ,CAAS,MAAb,EAAqB;AACjB;AACA,mBAAG,KAAH,CAAU,iCAAgC,KAAM,eAAc,YAAa,cAAa,IAAK,eAAc,IAAI,IAAJ,CAAS,MAAO,GAA3H,EAA+H,CAAC,GAAD,EAAM,IAAN,KAAc;AACzI,wBAAI,GAAJ,EAAS;AACL,gCAAQ,KAAR,CAAc,GAAd;AACA,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAHD,MAGO;AACH,4BAAI,QAAJ,CAAa,cAAb;AACH;AACJ,iBAPD;AAQH,aAVD,MAUO;AACH;AACA,mBAAG,KAAH,CAAU,kEAAiE,KAAM,OAAM,YAAa,OAAM,IAAK,IAA/G,EAAoH,CAAC,GAAD,EAAM,IAAN,KAAc;AAC9H,wBAAI,GAAJ,EAAS;AACL,gCAAQ,KAAR,CAAc,GAAd;AACA,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAHD,MAGO;AACH,4BAAI,QAAJ,CAAa,cAAb;AACH;AACJ,iBAPD;AAQH;AACJ;AACJ,KA/BD;AAgCA,WAAO,MAAP;AACH,CA7DD","file":"skill-compiled.js","sourcesContent":["const express = require('express');\r\nconst mysql = require('mysql');\r\n\r\nconst db = mysql.createPool({\r\n    host: 'localhost',\r\n    user: 'nodejs',\r\n    password: 'nodejs',\r\n    database:'resume',\r\n    port: 3306\r\n});\r\n\r\nmodule.exports = function () {\r\n    var router = express.Router();\r\n\r\n    router.get('/', (req, res)=> {\r\n        if (req.query.id) {\r\n            if (req.query.id != 'all') {\r\n                db.query(`DELETE FROM skill_table WHERE ID=${req.query.id}`, (err, data)=> {\r\n                    if (err) {\r\n                        res.status(500).send('database error').end();\r\n                    } else {\r\n                        res.redirect('/admin/skill')\r\n                    }\r\n                });\r\n            } else {\r\n                //全部删除逻辑\r\n                res.send('您暂时还没有权限删除全部数据').end();\r\n            }\r\n        } else {\r\n            db.query(`SELECT * FROM skill_table`, (err, experienceData)=> {\r\n                if (err) {\r\n                    res.status(500).send('database error').end();\r\n                } else {\r\n                    res.render('page/skill.ejs', {experienceData});\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    router.post('/', (req, res)=> {\r\n        \"use strict\";\r\n        //获取到提交的内容信息\r\n        var title = req.body.title;\r\n        var introduction = req.body.introduction;\r\n        var icon = req.body.icon;\r\n        if (!title || !introduction) {\r\n            res.status(400).send('填写内容不能为空').end();\r\n        } else {\r\n            if (req.body.mod_id) {\r\n                //修改逻辑\r\n                db.query(`UPDATE skill_table SET title='${title}', content='${introduction}', ic_src='${icon}' WHERE ID='${req.body.mod_id}'`, (err, data)=> {\r\n                    if (err) {\r\n                        console.error(err);\r\n                        res.status(500).send('database error').end();\r\n                    } else {\r\n                        res.redirect('/admin/skill');\r\n                    }\r\n                });\r\n            } else {\r\n                //新添加逻辑\r\n                db.query(`INSERT INTO experience_table (title, content, ic_src) VALUES( '${title}', '${introduction}', '${icon}')`, (err, data)=> {\r\n                    if (err) {\r\n                        console.error(err);\r\n                        res.status(500).send('database error').end();\r\n                    } else {\r\n                        res.redirect('/admin/skill');\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    })\r\n    return router;\r\n}"]}