{"version":3,"sources":["experience.js"],"names":[],"mappings":"AAAA,MAAM,UAAU,QAAQ,SAAR,CAAhB;AACA,MAAM,QAAQ,QAAQ,OAAR,CAAd;;AAEA,MAAM,KAAK,MAAM,UAAN,CAAiB;AACxB,UAAM,WADkB;AAExB,UAAM,QAFkB;AAGxB,cAAU,QAHc;AAIxB,cAAS,QAJe;AAKxB,UAAM;AALkB,CAAjB,CAAX;;AAQA,OAAO,OAAP,GAAiB,YAAY;AACzB,QAAI,SAAS,QAAQ,MAAR,EAAb;;AAEA,WAAO,GAAP,CAAW,GAAX,EAAgB,CAAC,GAAD,EAAM,GAAN,KAAa;AACzB,YAAG,IAAI,KAAJ,CAAU,EAAb,EAAgB;AACZ,gBAAG,IAAI,KAAJ,CAAU,EAAV,IAAgB,KAAnB,EAA0B;AACtB,mBAAG,KAAH,CAAU,yCAAwC,IAAI,KAAJ,CAAU,EAAG,EAA/D,EAAkE,CAAC,GAAD,EAAM,IAAN,KAAc;AAC5E,wBAAI,GAAJ,EAAS;AACL,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAFD,MAEO;AACH,4BAAI,QAAJ,CAAa,mBAAb;AACH;AACJ,iBAND;AAOH,aARD,MAQM;AACF;AACA,oBAAI,IAAJ,CAAS,gBAAT,EAA2B,GAA3B;AACH;AACJ,SAbD,MAaK;AACD,eAAG,KAAH,CAAU,gCAAV,EAA2C,CAAC,GAAD,EAAM,cAAN,KAAuB;AAC9D,oBAAG,GAAH,EAAO;AACH,wBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,iBAFD,MAEK;AACD,wBAAI,MAAJ,CAAW,qBAAX,EAAkC,EAAC,cAAD,EAAlC;AACH;AACJ,aAND;AAOH;AACJ,KAvBD;;AAyBA,WAAO,IAAP,CAAY,GAAZ,EAAiB,CAAC,GAAD,EAAM,GAAN,KAAY;AACzB;AACA;;AACA,YAAI,WAAW,IAAI,IAAJ,CAAS,IAAxB;AACA,YAAI,QAAQ,IAAI,IAAJ,CAAS,KAArB;AACA,YAAI,eAAe,IAAI,IAAJ,CAAS,YAA5B;AACA,YAAI,OAAO,IAAI,IAAJ,CAAS,IAApB;AACA,YAAG,CAAC,KAAD,IAAU,CAAC,YAAd,EAA2B;AACvB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,UAArB,EAAiC,GAAjC;AACH,SAFD,MAEK;AACD,gBAAG,IAAI,IAAJ,CAAS,MAAZ,EAAmB;AACf;AACA,mBAAG,KAAH,CAAU,yCAAwC,QAAS,aAAY,KAAM,eAAc,YAAa,kBAAiB,IAAK,eAAc,IAAI,IAAJ,CAAS,MAAO,GAA5J,EAAgK,CAAC,GAAD,EAAM,IAAN,KAAa;AACzK,wBAAG,GAAH,EAAO;AACH,gCAAQ,KAAR,CAAc,GAAd;AACA,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAHD,MAGK;AACD,4BAAI,QAAJ,CAAa,mBAAb;AACH;AACJ,iBAPD;AAQH,aAVD,MAUK;AACD;AACA,mBAAG,KAAH,CAAU,gFAA+E,QAAS,MAAK,KAAM,OAAM,YAAa,OAAM,IAAK,IAA3I,EAAgJ,CAAC,GAAD,EAAM,IAAN,KAAa;AACzJ,wBAAG,GAAH,EAAO;AACH,gCAAQ,KAAR,CAAc,GAAd;AACA,4BAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,gBAArB,EAAuC,GAAvC;AACH,qBAHD,MAGK;AACD,4BAAI,QAAJ,CAAa,mBAAb;AACH;AACJ,iBAPD;AAQH;AACJ;AACJ,KAhCD;AAiCA,WAAO,MAAP;AACH,CA9DD","file":"experience-compiled.js","sourcesContent":["const express = require('express');\r\nconst mysql = require('mysql');\r\n\r\nconst db = mysql.createPool({\r\n    host: 'localhost',\r\n    user: 'nodejs',\r\n    password: 'nodejs',\r\n    database:'resume',\r\n    port: 3306\r\n});\r\n\r\nmodule.exports = function () {\r\n    var router = express.Router();\r\n\r\n    router.get('/', (req, res)=> {\r\n        if(req.query.id){\r\n            if(req.query.id != 'all') {\r\n                db.query(`DELETE FROM experience_table WHERE ID=${req.query.id}`, (err, data)=> {\r\n                    if (err) {\r\n                        res.status(500).send('database error').end();\r\n                    } else {\r\n                        res.redirect('/admin/experience')\r\n                    }\r\n                });\r\n            }else {\r\n                //全部删除逻辑\r\n                res.send('您暂时还没有权限删除全部数据').end();\r\n            }\r\n        }else{\r\n            db.query(`SELECT * FROM experience_table`, (err, experienceData)=>{\r\n                if(err){\r\n                    res.status(500).send('database error').end();\r\n                }else{\r\n                    res.render('page/experience.ejs', {experienceData});\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    router.post('/', (req, res)=>{\r\n        \"use strict\";\r\n        //获取到提交的内容信息\r\n        var workTime = req.body.time;\r\n        var title = req.body.title;\r\n        var introduction = req.body.introduction;\r\n        var icon = req.body.icon;\r\n        if(!title || !introduction){\r\n            res.status(400).send('填写内容不能为空').end();\r\n        }else{\r\n            if(req.body.mod_id){\r\n                //修改逻辑\r\n                db.query(`UPDATE experience_table SET worktime='${workTime}', title='${title}', content='${introduction}', icon_color='${icon}' WHERE ID='${req.body.mod_id}'`, (err, data)=>{\r\n                    if(err){\r\n                        console.error(err);\r\n                        res.status(500).send('database error').end();\r\n                    }else{\r\n                        res.redirect('/admin/experience');\r\n                    }\r\n                });\r\n            }else{\r\n                //新添加逻辑\r\n                db.query(`INSERT INTO experience_table (worktime, title, content, icon_color) VALUES( '${workTime}','${title}', '${introduction}', '${icon}')`, (err, data)=>{\r\n                    if(err){\r\n                        console.error(err);\r\n                        res.status(500).send('database error').end();\r\n                    }else{\r\n                        res.redirect('/admin/experience');\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    })\r\n    return router;\r\n}"]}